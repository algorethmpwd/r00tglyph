{
  "level": 1,
  "category": "xss",
  "title": "Basic Reflected XSS - Complete Solution",
  "difficulty": "beginner",
  "summary": "This challenge demonstrates a basic reflected XSS vulnerability where user input from a URL parameter is directly embedded into the HTML response without sanitization.",

  "vulnerability_details": {
    "type": "Reflected XSS (Cross-Site Scripting)",
    "cwe": "CWE-79: Cross-site Scripting",
    "severity": "Medium to High",
    "description": "The application takes user input from the 'name' parameter and reflects it directly in the HTML response without proper encoding or validation."
  },

  "step_by_step_solution": [
    {
      "step": 1,
      "title": "Identify the Input Point",
      "description": "Examine the application and notice there's a 'name' parameter in the URL that gets displayed on the page.",
      "action": "Visit the page and observe how the name parameter value appears in the response.",
      "example": "URL: /xss/level1?name=TestUser shows 'Hello TestUser!' on the page"
    },
    {
      "step": 2,
      "title": "Test for Reflection",
      "description": "Confirm that user input is being reflected without sanitization by trying a simple HTML tag.",
      "action": "Modify the URL parameter with a basic HTML tag",
      "example": "URL: /xss/level1?name=<b>bold</b>",
      "expected_result": "If vulnerable, you'll see bold text rendered, confirming HTML injection is possible"
    },
    {
      "step": 3,
      "title": "Craft XSS Payload",
      "description": "Use a JavaScript payload to execute code in the browser context.",
      "action": "Replace the name parameter with a script tag containing JavaScript",
      "payload": "<script>alert('XSS Level 1 Completed!')</script>",
      "example": "URL: /xss/level1?name=<script>alert('XSS Level 1 Completed!')</script>"
    },
    {
      "step": 4,
      "title": "Execute the Attack",
      "description": "Navigate to the crafted URL to trigger the XSS payload.",
      "action": "Visit the URL with the malicious payload",
      "expected_result": "A JavaScript alert dialog should appear, indicating successful XSS execution"
    },
    {
      "step": 5,
      "title": "Capture the Flag",
      "description": "Once the XSS payload executes successfully, the challenge will be marked as completed and the flag will be displayed.",
      "action": "Look for the flag display after successful payload execution",
      "note": "The flag follows the format R00T{...} and is unique to your user session"
    }
  ],

  "successful_payloads": [
    {
      "payload": "<script>alert('XSS')</script>",
      "description": "Basic script tag injection - most common and effective",
      "encoding_notes": "May need URL encoding: %3Cscript%3Ealert%28%27XSS%27%29%3C%2Fscript%3E"
    },
    {
      "payload": "<img src=x onerror=alert('XSS')>",
      "description": "Image tag with error event handler",
      "advantages": "Works even if script tags are filtered"
    },
    {
      "payload": "<svg onload=alert('XSS')>",
      "description": "SVG element with onload event",
      "advantages": "Shorter payload, immediate execution"
    },
    {
      "payload": "javascript:alert('XSS')",
      "description": "JavaScript protocol (context-dependent)",
      "note": "Works in href attributes and some other contexts"
    }
  ],

  "tools_used": [
    {
      "name": "Browser Developer Tools",
      "purpose": "Inspect HTML source and DOM structure",
      "usage": "Press F12, go to Elements tab, observe how input is reflected"
    },
    {
      "name": "URL Encoding Tools",
      "purpose": "Encode special characters for URL parameters",
      "usage": "Use online tools or browser console: encodeURIComponent(payload)"
    },
    {
      "name": "Burp Suite (Optional)",
      "purpose": "Intercept and modify HTTP requests",
      "usage": "Capture request, modify parameter value, forward request"
    }
  ],

  "technical_analysis": {
    "root_cause": "Insufficient input validation and output encoding",
    "vulnerable_code_pattern": "Directly embedding user input: echo 'Hello ' . $_GET['name'] . '!';",
    "attack_vector": "URL parameter manipulation",
    "impact": "JavaScript execution in victim's browser context"
  },

  "prevention_measures": [
    {
      "method": "Output Encoding",
      "description": "Encode user input before displaying in HTML context",
      "implementation": "Use htmlspecialchars() in PHP, html.escape() in Python, or equivalent functions",
      "example": "htmlspecialchars($_GET['name'], ENT_QUOTES, 'UTF-8')"
    },
    {
      "method": "Input Validation",
      "description": "Validate and sanitize input data",
      "implementation": "Whitelist allowed characters, reject dangerous patterns",
      "example": "Only allow alphanumeric characters and spaces for name fields"
    },
    {
      "method": "Content Security Policy (CSP)",
      "description": "Implement CSP headers to prevent inline script execution",
      "implementation": "Add CSP header: Content-Security-Policy: default-src 'self'; script-src 'self'",
      "benefit": "Mitigates XSS even if other protections fail"
    },
    {
      "method": "HTTP-Only Cookies",
      "description": "Set HttpOnly flag on sensitive cookies",
      "benefit": "Prevents JavaScript access to session cookies via XSS"
    }
  ],

  "learning_outcomes": [
    "Understanding of reflected XSS vulnerability mechanics",
    "Experience with basic XSS payload construction",
    "Knowledge of HTML context and JavaScript execution",
    "Familiarity with browser developer tools for security testing",
    "Awareness of proper input/output handling practices"
  ],

  "real_world_examples": [
    {
      "scenario": "Search Results Page",
      "description": "E-commerce site reflects search query in results page header",
      "risk": "Attackers can craft malicious search URLs to steal user sessions"
    },
    {
      "scenario": "Error Messages",
      "description": "Application displays user input in error messages without encoding",
      "risk": "Phishing attacks through crafted error pages"
    },
    {
      "scenario": "User Profile Display",
      "description": "Social media platform displays username without proper escaping",
      "risk": "Persistent XSS if username stored in database"
    }
  ],

  "next_steps": [
    "Progress to XSS Level 2 for DOM-based XSS challenges",
    "Practice with different XSS contexts (attribute, JavaScript, CSS)",
    "Learn about XSS filter bypass techniques",
    "Study Content Security Policy implementation"
  ],

  "references": [
    "OWASP XSS Prevention Cheat Sheet",
    "PortSwigger Web Security Academy - XSS",
    "MDN Web Docs - Content Security Policy",
    "CWE-79: Cross-site Scripting"
  ]
}
